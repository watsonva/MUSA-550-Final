<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MUSA 550 Quarto Template – section_2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analysis/index.html">Trrendy Introduction</a></li><li class="breadcrumb-item"><a href="../analysis/section_2.html">2. Predict Airbnb Price</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/cover.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://www.linkedin.com/in/watsonvv/" rel="" title="Linkedin" class="quarto-navigation-tool px-1" aria-label="Linkedin"><i class="bi bi-linkedin"></i></a>
    <a href="https://github.com/watsonva" rel="" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/vanarcher_" rel="" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trrendy Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/section_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Explore Data Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/section_2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2. Predict Airbnb Price</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/section_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. UI Design</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#predict-airbnb-price" id="toc-predict-airbnb-price" class="nav-link active" data-scroll-target="#predict-airbnb-price">2. Predict Airbnb Price</a>
  <ul class="collapse">
  <li><a href="#data-exploratory" id="toc-data-exploratory" class="nav-link" data-scroll-target="#data-exploratory">2.1 Data Exploratory</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering">2.2 Feature Engineering</a>
  <ul class="collapse">
  <li><a href="#current-feature-investigation" id="toc-current-feature-investigation" class="nav-link" data-scroll-target="#current-feature-investigation">2.2.1 Current Feature Investigation</a></li>
  <li><a href="#feature-collect" id="toc-feature-collect" class="nav-link" data-scroll-target="#feature-collect">2.2.2 Feature Collect</a></li>
  <li><a href="#knn-methods-of-features" id="toc-knn-methods-of-features" class="nav-link" data-scroll-target="#knn-methods-of-features">2.2.3 KNN methods of features</a></li>
  </ul></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">2.3 Correlation Analysis</a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit">2.4 Model Fit</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">2.5 Model Evaluation</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/watsonva/MUSA-550-Final/blob/main/analysis/section_2.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="predict-airbnb-price" class="level1">
<h1>2. Predict Airbnb Price</h1>
<p>To predict Airbnb Price, we will go through the following 5 parts:</p>
<ol type="1">
<li><p>Data Exploratory</p></li>
<li><p>Feature Engineering</p></li>
<li><p>Feature Collect</p></li>
<li><p>Model Building</p></li>
<li><p>Predict</p></li>
</ol>
<section id="data-exploratory" class="level2">
<h2 class="anchored" data-anchor-id="data-exploratory">2.1 Data Exploratory</h2>
<p><img src="diagram/price_histogram.png" class="img-fluid"></p>
<p>Firstly, we analyze the distribution of Airbnb prices via two histograms of Prices &amp; log-transformed prices and a Quantile-Quantile. Through all these three plots, we get that while most prices are clustered at a lower range, there is significant variation and potentially many outliers on the higher end. To avoid unaccuracy of price predicting, we will delete some outliers and NA values before the next feature engineering section.</p>
<p><img src="diagram/detail/price_average_nhood.png" class="img-fluid"></p>
<p>Again, we plot spatial distribution of Airbnb price in the form of both points and neighbourhood. A high spatial autocorrelation phenomenon can be easily caught above, which will help us do a better feature selection in the next step.</p>
</section>
<section id="feature-engineering" class="level2">
<h2 class="anchored" data-anchor-id="feature-engineering">2.2 Feature Engineering</h2>
<section id="current-feature-investigation" class="level3">
<h3 class="anchored" data-anchor-id="current-feature-investigation">2.2.1 Current Feature Investigation</h3>
<p><img src="diagram/feature_distribution.png" class="img-fluid"></p>
<p>After filtering all NA values, we get a nice distribution of features above via <code>missingno</code> package.</p>
</section>
<section id="feature-collect" class="level3">
<h3 class="anchored" data-anchor-id="feature-collect">2.2.2 Feature Collect</h3>
<p>Since Airbnb price will not only affected by propeties itself, it can also affected by nearby neighborhood properties. We select the following six factors for our feature preparation:</p>
<ul>
<li><ol type="1">
<li>Crime</li>
</ol></li>
<li><ol start="2" type="1">
<li>311</li>
</ol></li>
<li><ol start="3" type="1">
<li>Civic Art Collection</li>
</ol></li>
<li><ol start="4" type="1">
<li>Recreation and Parks Properties</li>
</ol></li>
<li><ol start="5" type="1">
<li>Bicycle Parking</li>
</ol></li>
<li><ol start="6" type="1">
<li>Restaurant</li>
</ol></li>
</ul>
<p>For each feature collect process, we go through these 3 steps:</p>
<ul>
<li><ol type="1">
<li>Get data during URL</li>
</ol></li>
<li><ol start="2" type="1">
<li>Extract ‘Latitude’ and ‘Longitude’ from the original dataset</li>
</ol></li>
<li><ol start="3" type="1">
<li>Convert the dataset into geodataframe</li>
</ol></li>
</ul>
</section>
<section id="knn-methods-of-features" class="level3">
<h3 class="anchored" data-anchor-id="knn-methods-of-features">2.2.3 KNN methods of features</h3>
<p>To get a better details spatail learning, we add KNN method of six features via the following 6 steps</p>
<ul>
<li>Step1: Extract x/y from crime</li>
<li>Step2: Initialize the algorithm</li>
<li>Step3: Fit the algorithm on the “neighbors” dataset</li>
<li>Step4: Get distances for airbnb to</li>
<li>Step5: Average distance to neighbors</li>
<li>Step6: Set zero distances to be small, but nonzero</li>
</ul>
<p><img src="diagram/features_collected.png" class="img-fluid"></p>
</section>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">2.3 Correlation Analysis</h2>
<p><img src="diagram/correlation.png" class="img-fluid"></p>
<p>Have both Airbnb property feature and nearby neighbourhood feature prepared, we did a correlation analysis as above. It seems <code>crime</code> , <code>311 call</code>, and <code>art</code> data has strong correlations while other features not, which can be a good indicator for future model iteration.</p>
</section>
<section id="model-fit" class="level2">
<h2 class="anchored" data-anchor-id="model-fit">2.4 Model Fit</h2>
<p>During model fit process, we choose randomforest regression model and mainly go through the following steps:</p>
<ul>
<li><ol type="1">
<li>Split data by 70% for training set and 30% for test set.</li>
</ol></li>
<li><ol start="2" type="1">
<li>set “price” as the target labels for both train and test sets</li>
</ol></li>
<li><ol start="3" type="1">
<li>Set up a pipeline that includes both numerical columns and categorical columns</li>
</ol></li>
<li><ol start="4" type="1">
<li>Initialize the pipeline</li>
</ol></li>
<li><ol start="5" type="1">
<li>Fit the model with training set</li>
</ol></li>
</ul>
<p>Next, We got the following testing score by implement the baseline model on test set.</p>
<p>Testing Score = 0.34280431620306995</p>
<p>The Score is moderate.</p>
<p>For a better model iteration, we need to know more about the feature importance, as we can see from the plot below, the top 5 important features are:</p>
<ul>
<li><ol type="1">
<li>accommodates</li>
</ol></li>
<li><ol start="2" type="1">
<li>beds</li>
</ol></li>
<li><ol start="3" type="1">
<li>LaggedPrice</li>
</ol></li>
<li><ol start="4" type="1">
<li>minimum_nights</li>
</ol></li>
<li><ol start="5" type="1">
<li>log_crime</li>
</ol></li>
</ul>
<p><embed src="diagram/importance_bar.html" class="img-fluid"></p>
</section>
<section id="model-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation">2.5 Model Evaluation</h2>
<p>For model evaluation steps, we calculated the predicted price, percent error as well as absolute percent error for each observation. To better understand the spatial autocorrelation, we plotted both the spatial distribution of the percent error and the mean absolute percet error by neighborhood in test set.</p>
<p><img src="diagram/model_validation.png" class="img-fluid"></p>
<p>From the plot above, we can see that the errors of prediction Airbnb price do have few spatial cluster, which means the effects of spatial autocorrelation still exist, which is in line with the observations we made in the previous correlation analysis stage.</p>
<p>In conclusion, although the model itself still has improvement space, we have identified the flaws and the direction for iteration. After removing some interrelated features and adding more features, our model can better assist users in predicting house prices, while also helping hosts make better adjustments and plans for their properties.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Watson Van Archer, 2023</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with MUSA <span class="citation" data-cites="PENN">@PENN</span> and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>